import os
import zipfile
import bz2
import json
import string

cur_folder = os.getcwd()
files = os.listdir(cur_folder)

for file in files:
    if file.endswith(".bz2"):
        archive = bz2.open(file)

        binary_text = archive.read()
        decoded_text = str(binary_text, "utf-8")
        archive.close()

        filename = "JsonFolder/" + file[:len(file)-4] + ".json"
        dirname = os.path.dirname(filename)
        if not os.path.exists(dirname):
            os.makedirs(dirname)
        json_file = open(filename, "w")
        json_file.write(decoded_text)
        json_file.close()


most_used_woeds = {}
for i in os.listdir(cur_folder+"\\JsonFolder"):
    js = open("JsonFolder\\"+i, 'r').readlines()
    for dictionary in js:
        obj = json.loads(dictionary)

        body = obj["body"]
        if body == "[deleted]":
            continue
        for word in body.split():
            word = word.translate(str.maketrans('', '', string.punctuation))
            if len(word) < 3:
                continue
            if (most_used_woeds.get(word, 0)):
                most_used_woeds[word] += 1
            else:
                most_used_woeds[word] = 1

most_used_woeds = sorted(most_used_woeds.items(), key=lambda x: (x[1], x[0]), reverse=True)
number = 20
for i in range(number):
    print(str(i+1)+". " + str(most_used_woeds[i][0]))
